<!DOCTYPE html>
<html>
<head>
    <title>WebSocket Test</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.5.1/sockjs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        #messages { border: 1px solid #ccc; padding: 10px; height: 300px; overflow-y: scroll; background: #f9f9f9; }
        .new-task { color: green; font-weight: bold; }
    </style>
</head>
<body>
<h2>Test WebSocket Client</h2>
<div>
    Status: <span id="status" style="color:red">Disconnected</span>
</div>
<br/>
<h3>Live Notifications (Group 1):</h3>
<div id="messages"></div>

<script>
    var stompClient = null;

    function connect() {
        // –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ —Ç–æ–π —Ç–æ—á–∫–µ, –∫–æ—Ç–æ—Ä—É—é –º—ã –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏ –≤ WebSocketConfig
        var socket = new SockJS('http://localhost:8080/ws');
        stompClient = Stomp.over(socket);

        stompClient.connect({}, function (frame) {
            document.getElementById("status").innerHTML = "Connected ‚úÖ";
            document.getElementById("status").style.color = "green";
            console.log('Connected: ' + frame);

            // –ü–û–î–ü–ò–°–´–í–ê–ï–ú–°–Ø –Ω–∞ —Ç–µ–º—É –≥—Ä—É–ø–ø—ã ‚Ññ1 (–∫–∞–∫ –ø—Ä–æ–ø–∏—Å–∞–Ω–æ –≤ TaskService)
            stompClient.subscribe('/topic/group/4/tasks', function (message) {
                showMessage(JSON.parse(message.body));
            });
        });
    }

    function showMessage(task) {
        var messagesDiv = document.getElementById("messages");
        var p = document.createElement('p');
        p.className = 'new-task';
        // –í—ã–≤–æ–¥–∏–º –¥–∞–Ω–Ω—ã–µ, –ø—Ä–∏—à–µ–¥—à–∏–µ —Å —Å–µ—Ä–≤–µ—Ä–∞
        p.innerHTML = "üîî New Task: " + task.title + " (ID: " + task.taskId + ")";
        messagesDiv.appendChild(p);
    }

    // –ó–∞–ø—É—Å–∫–∞–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å—Ä–∞–∑—É –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏
    connect();
</script>
</body>
</html>